<div class="header-row">
  <h2>Astronauts</h2>
  <a mat-raised-button color="primary" routerLink="/person/create">
    <mat-icon>person_add</mat-icon> Add Person
  </a>
</div>

@if (loading()) {
  <div class="center"><mat-spinner diameter="40" /></div>
} @else if (error()) {
  <p class="error">{{ error() }}</p>
} @else if (people().length === 0) {
  <p>No astronauts found. Add one to get started.</p>
} @else {
  <table mat-table [dataSource]="people()">
    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef>Name</th>
      <td mat-cell *matCellDef="let person">
        <a [routerLink]="['/person', person.name]">{{ person.name }}</a>
      </td>
    </ng-container>

    <ng-container matColumnDef="currentRank">
      <th mat-header-cell *matHeaderCellDef>Rank</th>
      <td mat-cell *matCellDef="let person">{{ person.currentRank || '—' }}</td>
    </ng-container>

    <ng-container matColumnDef="currentDutyTitle">
      <th mat-header-cell *matHeaderCellDef>Duty</th>
      <td mat-cell *matCellDef="let person">{{ person.currentDutyTitle || '—' }}</td>
    </ng-container>

    <ng-container matColumnDef="careerStartDate">
      <th mat-header-cell *matHeaderCellDef>Career Start</th>
      <td mat-cell *matCellDef="let person">{{ person.careerStartDate ? (person.careerStartDate | date:'mediumDate') : '—' }}</td>
    </ng-container>

    <ng-container matColumnDef="careerEndDate">
      <th mat-header-cell *matHeaderCellDef>Career End</th>
      <td mat-cell *matCellDef="let person">{{ person.careerEndDate ? (person.careerEndDate | date:'mediumDate') : '—' }}</td>
    </ng-container>

    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let person">
        <a mat-button [routerLink]="['/duty/create', person.name]">Assign Duty</a>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
}
